---
title: ラプラシアンの極座標表示
date: 2021-03-30 11:36:16
category: 数学
mathjax: true
---
物理系ではないので使わないが, 微分作用素の取り扱いに慣れる目的でメモ。
しかし, お気持ちは全く理解できていない。

$\Delta = \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2}$を$(r, \theta)$で表す。
初めに$x = r\cos\theta, y = r\sin\theta$より$r, \theta$を$x, y$で表す。
$$r^2  = x^2 + y^2$$より
$$r = \sqrt{x^2 + y^2}\ \ (r \geq 0)$$
$$\tan \theta = \frac{y}{x}$$より
$$\theta = Tan^{-1}(\frac{y}{x})$$

### 連鎖律(チェインルール)
$$\frac{\partial}{\partial x} = \frac{\partial r}{\partial x}\frac{\partial}{\partial r} + \frac{\partial \theta}{\partial x}\frac{\partial }{\partial \theta}$$
手持ちの微積の教科書等には
$$\frac{\partial}{\partial x} = \frac{\partial}{\partial r}\frac{\partial r}{\partial x} + \frac{\partial }{\partial \theta}\frac{\partial \theta}{\partial x}$$
こう記してあるが, その記法だと$\frac{\partial}{\partial r}$が$\frac{\partial r}{\partial x}$に作用しそうで怖い。
関数$f$をいれて次のように書くと馴染みがあるかもしれない。
$$\frac{\partial f(r, \theta)}{\partial x} = \frac{\partial f(r, \theta)}{\partial r}\frac{\partial r}{\partial x} + \frac{\partial f(r, \theta)}{\partial \theta}\frac{\partial \theta}{\partial x}$$
ここで, 
$$\frac{\partial r}{\partial x} = \frac{x}{\sqrt{x^2 + y^2}} = \cos\theta$$
$$\frac{\partial \theta}{\partial x} = -\frac{\sin\theta}{r}$$
$$\frac{\partial r}{\partial y} = \frac{y}{\sqrt{x^2 + y^2}} = \sin\theta$$
$$\frac{\partial \theta}{\partial y} =\frac{\cos\theta}{r}$$
より
$$\frac{\partial}{\partial x} = \frac{\partial r}{\partial x}\frac{\partial}{\partial r} + \frac{\partial \theta}{\partial x}\frac{\partial }{\partial \theta}$$
$$ = \cos\theta\frac{\partial}{\partial r} - \frac{\sin\theta}{r}\frac{\partial }{\partial \theta}$$
$$\frac{\partial}{\partial y} = \frac{\partial r}{\partial y}\frac{\partial}{\partial r} + \frac{\partial \theta}{\partial y}\frac{\partial }{\partial \theta}$$
$$ = \sin\theta\frac{\partial}{\partial r} + \frac{\cos\theta}{r}\frac{\partial }{\partial \theta}$$
ここから2乗にしていく。
$$\frac{\partial^2}{\partial x^2} = \left(\frac{\partial}{\partial x}\right)^2$$
$$=\left(\cos\theta\frac{\partial}{\partial r} - \frac{\sin\theta}{r}\frac{\partial }{\partial \theta}\right)^2$$
$$ = \cos^2\theta\frac{\partial^2}{\partial r^2} - \frac{2\sin\theta\cos\theta}{r}\frac{\partial}{\partial r \partial\theta} + \frac{\sin^2\theta}{r^2}\frac{\partial^2 }{\partial \theta^2}$$
としたくなるが, そうはいかない。正しくは
$$\frac{\partial^2}{\partial x^2} =\left(\cos\theta\frac{\partial}{\partial r} - \frac{\sin\theta}{r}\frac{\partial }{\partial \theta}\right)^2$$
$$=\left(\cos\theta\frac{\partial}{\partial r} - \frac{\sin\theta}{r}\frac{\partial }{\partial \theta}\right)\left(\cos\theta\frac{\partial}{\partial r} - \frac{\sin\theta}{r}\frac{\partial }{\partial \theta}\right)$$
$$=\cos\theta\frac{\partial}{\partial r}\left(\cos\theta\frac{\partial}{\partial r} - \frac{\sin\theta}{r}\frac{\partial }{\partial \theta}\right) -  \frac{\sin\theta}{r}\frac{\partial }{\partial \theta}\left(\cos\theta\frac{\partial}{\partial r} - \frac{\sin\theta}{r}\frac{\partial }{\partial \theta}\right)$$
つまり, 積の微分になる。
$$=\cos\theta\left(\cos\theta\frac{\partial^2}{\partial r^2} + \frac{\sin\theta}{r^2}\frac{\partial }{\partial \theta} - \frac{\sin\theta}{r}\frac{\partial^2}{\partial r \partial\theta}\right) -  \frac{\sin\theta}{r}\left(-\sin\theta\frac{\partial}{\partial r} + \cos\theta\frac{\partial^2}{\partial r \partial\theta} - \frac{\cos\theta}{r}\frac{\partial }{\partial \theta} - \frac{\sin\theta}{r}\frac{\partial^2 }{\partial \theta^2}\right)$$
$$=\cos^2\theta\frac{\partial^2}{\partial r^2}+\frac{\sin^2\theta}{r}\frac{\partial}{\partial r} - \frac{2\sin\theta\cos\theta}{r}\frac{\partial^2}{\partial r \partial\theta}+\frac{\sin^2\theta}{r^2}\frac{\partial^2 }{\partial \theta^2}+\frac{2\sin\theta\cos\theta}{r^2}\frac{\partial}{\partial \theta}$$
同様に$y$についても辛い計算を行う。
$$\frac{\partial^2}{\partial y^2} = \left(\sin\theta\frac{\partial}{\partial r} + \frac{\cos\theta}{r}\frac{\partial }{\partial \theta}\right)\left(\sin\theta\frac{\partial}{\partial r} + \frac{\cos\theta}{r}\frac{\partial }{\partial \theta}\right)$$
$$=\sin\theta\frac{\partial}{\partial r}\left(\sin\theta\frac{\partial}{\partial r} + \frac{\cos\theta}{r}\frac{\partial }{\partial \theta}\right) + \frac{\cos\theta}{r}\frac{\partial }{\partial \theta}\left(\sin\theta\frac{\partial}{\partial r} + \frac{\cos\theta}{r}\frac{\partial }{\partial \theta}\right)$$
$$=\sin\theta\left(\sin\theta\frac{\partial^2}{\partial r^2} - \frac{\cos\theta}{r^2}\frac{\partial }{\partial \theta}+ \frac{\cos\theta}{r}\frac{\partial^2 }{\partial r \partial \theta}\right) + \frac{\cos\theta}{r}\left(\cos\theta\frac{\partial}{\partial r}+\sin\theta\frac{\partial^2}{\partial r \partial \theta} - \frac{\sin\theta}{r}\frac{\partial }{\partial \theta}+ \frac{\cos\theta}{r}\frac{\partial^2 }{\partial \theta^2}\right)$$
$$=\sin^2\theta\frac{\partial^2}{\partial r^2} + \frac{\cos^2\theta}{r}\frac{\partial}{\partial r} + \frac{2\sin\theta\cos\theta}{r}\frac{\partial^2 }{\partial r \partial \theta} + \frac{\cos^2\theta}{r^2}\frac{\partial^2 }{\partial \theta^2}- \frac{2\sin\theta\cos\theta}{r^2}\frac{\partial }{\partial \theta}$$
以上より
$$\Delta = \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2}$$
$$ = \frac{\partial^2}{\partial r^2}+ \frac{1}{r}\frac{\partial}{\partial r}+ \frac{1}{r^2}\frac{\partial^2 }{\partial \theta^2}$$
終わり。
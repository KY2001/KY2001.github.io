---
title: 整数に関するメモ
date: 2021-03-20 02:28:09
category: 数学
mathjax: true
---
非常に苦手。ブラックボックスは良くないので雑に勉強。内容は無益です。
### 合同式 $ca \equiv cb \ \ (mod \ m)$

1. $gcd(c, m) = 1$のとき(cとmが互いに素)
   $$a \equiv b \ \ (mod \  m)$$
2. $gcd(c, m) = G > 1$のとき
   $$a \equiv b \ \ (mod \ \frac{m}{G})$$

特に$ca \equiv cb \ \ (mod \ cm)$ $\Leftrightarrow$ $a \equiv b \ \ (mod \ m)$

[証明]
$$ca \equiv cb \ \ (mod \ m)$$
$$\Leftrightarrow \ c(a - b) \equiv 0 (mod \ m)$$
不定方程式に変形ができて
$$\Leftrightarrow \ c(a - b) = mt \ \  (t \in Z)$$
$$\Leftrightarrow \ a - b = m\frac{t}{c}$$

1. $gcd(c, m) = 1$のとき(cとmが互いに素)
   左辺$a - b$は整数より$\frac{t}{c}$は整数であるから
   $$a \equiv b \ \ (mod \  m)$$
2. $gcd(c, m) = G > 1$のとき
   $\Leftrightarrow \ \frac{c}{G}(a - b) = \frac{m}{G}t$と変形できて上の1.に帰着される。
   $$a \equiv b \ \ (mod \ \frac{m}{G})$$

### モジュラ逆数 $a^{-1} \equiv x \ \ (mod \ m)$が存在する必要十分条件
aとmが互いに素であること。
このとき$a*a^{-1} \equiv 1 \ \ (mod \ m)$ならば$a^{-1}$は$a$のモジュラ逆数である。

### ユークリッドの互除法
２つの自然数a, bの最大公約数を求めるアルゴリズム。
$G = gcd(a, b)$とすると$a = Ga', b = Gb'$とかける。
このとき
$$a = b * k + r$$
$$\Leftrightarrow Ga' = Gb' * k + r$$
$$\Leftrightarrow G(a' - b' * k) = r$$
よって余りであるrはaとbの最大公約数Gを約数とするので, bとrについて同様にして余り$r = G$となるまで計算を行えばよい。

ex.1 : 1071と1029の最大公約数を求める。
$a = 1071, b = 1029$として
$$1071 = 1029 * 1 + 42$$
このとき42はgcd(a, b)を約数とする。
$$1029 = 42 * 24 + 21$$
$$42 = 21 * 2 + 0$$
よって42と21の最大公約数は21である。
$\Rightarrow$ 21が1071と1029の最大公約数である。

### 拡張ユークリッドの互除法
不定方程式$ax + by = gcd(a, b)$を満たす整数解(x, y)が存在する。
また, 整数解(a, b)は計算できる。←"拡張"部分

ex.2 : 2元1次不定方程式 $27x - 11y = -5$の一般解を求める
↓の定理より↑の不定方程式が解を持つ$\Rightarrow$-5がgcd(27, 11)の倍数であるから, 解を持つと仮定すると27a - 11b = gcd(27, 11)の両辺を-5/gcd(27, 11)倍してやれば解が求まる。よってまずgcd(27, 11)と27x - 11y = gcd(27, 11)の解を求める。ユークリッドの互除法→拡張ユークリッドの互除法をやる。
$$27 = 11 * 2 + 5$$
$$11 = 5 * 2 + 1$$
$$5 = 1 * 5 + 0$$
よってgcd(27, 11) = 1がわかる。上の式を変形して
$$5 = 27 - 11 * 2$$
$$1 = 11 - 5 * 2 = 11 - (27 - 11 * 2) * 2$$
$$1 = 27 * -2 - 11 * -5$$
$$27 * 10 - 11 * 25 = -5$$
↑を$27x - 11y = -5$に引いて
$$27(x - 10) - 11(y - 25) = 0$$
$$27(x - 10) = 11(y - 25)$$
x - 10とy - 25がそれぞれ11と25を約数に持つことがわかり, 一般解は
$$x = 11t + 10, y = 27t + 25$$

定理1: 不定方程式$ax + by = c$が整数解(x, y)を持つ$\Leftrightarrow$cがgcd(a, b)の倍数である。
[十分条件の証明]
整数解(x, y)が存在すると仮定すると
$ax + by = G(a'x + b'y) = c$よりcはGの倍数である。
また, aとbが互いに素である$\Rightarrow$任意の整数がax + byの形で表せる=必要条件

定理2: 不定方程式$ax + by = 1$が整数解(x, y)を持つ$\Leftrightarrow$aとbが互いに素である。
[証明]定理1よりc = 1がgcd(a, b)の倍数であれば良い。すなわちgcd(a, b) = 1であり, aとbが互いに素であれば良い。

### 1次合同式 $ax \equiv b \ \ (mod \ m)$

1. $gcd(a, m) = 1$のとき(cとmが互いに素)
   1つの解をもつ。
2. $gcd(a, m) = G > 1$のとき
   Gがbの約数であるときのみd個の解をもつ。
(1次合同式$ax \equiv b \ \ (mod \ m)$は不定方程式$ax - b = my$を解くことと同値である。)

### 中国余剰定理(CRT: Chinese Remainder Therorem)
整数$x$が次の連立合同式を満たすとする。
$$x \equiv a_i\ (mod \ m_i)\ (1 \leq i \leq n)$$
$m_i$ がどの2つも互いに素であるならば, $x$ は $0 \leq x < \prod n_i$ の範囲に一意に存在する。よって, $x$ の一般解は次のように表される。
$$X \equiv x\ (mod\  \prod m_i)\ (1 \leq i \leq n)$$
なお, $x$は $O(nlog(lcm(m_i)))$ で計算できる。→(https://atcoder.github.io/ac-library/production/document_ja/math.html)

### 中国余剰定理の一般化(法が互いに素でない場合への拡張)
整数$x$が次の連立合同式を満たすとする。
$$x \equiv a_i\ (mod \ m_i)\ (1 \leq i \leq n)$$
上の連立合同式の一般解$X$が存在する必要十分条件は
「任意のiとjに対して$a_i \equiv a_j\ (mod\ gcd(n_i, n_j))$が成り立つ」

詳しく→(https://manabitimes.jp/math/838)


### フェルマーの小定理
素数$p$について整数$a$が$p$の倍数でなければ
$$a^{p-1} \equiv 1\  (mod \ p)$$
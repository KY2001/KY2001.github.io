---
title: 推定と検定
date: 2021-04-04 18:19:53
category: 数学
mathjax: true
---
ふわふわが解消されつつあるがはっきりとは分からない。
気をつけたい点を中心に軽くメモ。
### 推定
得られた標本(sample)を元に母集団の母数(平均$\mu$や分散$\sigma^2$等の母集団を特徴づける値)を推定する。
・値を推定:点推定
・何%の確率でどの範囲にいるのか推定:区間推定
以下全て母集団が正規分布$N(\mu, \sigma^2)$に従うとする。
標本数:$n$
標本平均:$\overline{X}=\frac{1}{n}\sum{X_i}$
不偏分散:$S^2=\frac{1}{n-1}\sum{(X_i-\overline{X})^2}$
##### 区間推定
1. 母平均$\mu$の区間推定($\sigma^2$は未知)
確率変数$Z$を
$$Z=\frac{\overline{X}-\mu}{\sqrt{\frac{S^2}{n}}}$$
とすると, $Z$は自由度$n-1$の$t$分布に従う。
2. 母平均$\mu$の区間推定($\sigma^2$は既知)
確率変数$Z$を
$$Z=\frac{\overline{X}-\mu}{\sqrt{\frac{\sigma^2}{n}}}$$
とすると, $Z$は標準正規分布$N(0, 1)$に従う。
3. 母分散$\sigma^2$の区間推定($\mu$は未知)
確率変数$Z$を
$$Z=\sum{\left(\frac{X_i-\overline{X}}{\sigma}\right)^2}$$
とすると, $Z$は自由度$n-1$の$\chi^2$分布に従う。

@疑問点
・$\mu$に関して推定する訳だからなぜ$Z=\frac{\overline{X}-\mu}{\sqrt{\frac{S^2}{n}}}$なのか, 符号的に$Z=\frac{\mu-\overline{X}}{\sqrt{\frac{S^2}{n}}}$が適切ではないか。
$ans:$ 有意水準$\alpha$を定めて
$$-\frac{\alpha}{2}\leq Z\leq\frac{\alpha}{2}$$
とする訳なので両者は同値。もし, $-\beta\leq Z \leq \alpha$の推定をするとなったら面倒くさいことになるが基本的に無い? また, 検定における検定統計量を定めることを考えると↑の定め方でないと面倒くさいことになる。

・$\sigma^2$が未知な状態と既知な状態で持っている情報量に差があるわけだから$\mu$の信頼区間は狭くなるのか
$ans:$ 確かめたい。

### 検定
手順
1. 母数に関する仮説$H_0:\theta=\theta_0$を立てる。
2. 検定統計量$T$を定める。(推定の確率変数と同じ)
例えば, 仮説が$\mu=\mu_0$だとすると, 
$$T=\frac{\overline{X}-\mu_0}{\sqrt{\frac{S^2}{n}}}$$
とする。
3. 検定統計量$T$が従う分布から棄却域$R:T<\beta, \alpha<T$を定める。
4. 検定統計量$T$の実現値$t$(実際に標本平均$\overline{X}$を$T$に代入した値)を求める。
5. $T \in R$ならば仮説$H_0$は棄却される。
 $T \notin R$ならば仮説$H_0$は棄却されない。

@注意&疑問
・先の推定では母数である$\mu$や$\sigma^2$について考えたが, 今回では逆で$\overline{X}$が果たして仮説を棄却するかを確かめている。その意味で$\overline{X}-\mu_0$は適切。
・検定では有意水準$\alpha$を低くとる。その意味で棄却を前提としており, 棄却されない$\Rightarrow$採用とはいかない。
・ある仮説を採用したいとき, 例えば$\mu>10$を採用したいとなれば, この仮説の否定$\mu=10$を右側検定する(すなわち, $\mu$が有意水準$\alpha$の確率で$\beta$以上であるとき, $\mu=10>\beta$(=棄却される)かどうかを推定する)。このとき, $H_0:\mu=10$を帰無仮説, $H_1:\mu>10$を対立仮説という。(棄却する=対立仮説を採用する前提の元立てる仮説なので帰無仮説, 帰無仮説と対するものなので対立仮説。)
・示したいことを背理法で示す的な目的でこの理解し難い面倒なシステムが構築されたらしい。また, 帰無仮説が棄却されたにも関わらず対立仮説が誤りであることを"第◯の誤り"と呼んだりするらしい。
・シンプルに$\mu>\beta$を保証したいなら保証率みたいな形で$\alpha\sim 1$を定めて$\mu>\beta$となる確率が$\alpha$以上となる$\beta$を出せばいいのにと思うのだが, (コンピュータで近似値が出せるはず)分布表に汎用性が無くなるからなのか等考えています。
